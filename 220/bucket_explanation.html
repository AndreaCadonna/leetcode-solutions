<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ü™£ Bucket Pattern: Contains Duplicate III</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      .header {
        text-align: center;
        color: white;
        margin-bottom: 30px;
      }

      .header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }

      .header p {
        font-size: 1.2em;
        opacity: 0.9;
      }

      .content-card {
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        margin-bottom: 30px;
      }

      .section {
        padding: 30px;
        border-bottom: 1px solid #eee;
      }

      .section:last-child {
        border-bottom: none;
      }

      .section-title {
        font-size: 1.8em;
        color: #2c3e50;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .section-title::before {
        content: "";
        width: 4px;
        height: 30px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        border-radius: 2px;
      }

      .subsection {
        margin: 25px 0;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        border-left: 4px solid #667eea;
      }

      .subsection h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 1.3em;
      }

      .code-block {
        background: #2d3748;
        color: #e2e8f0;
        padding: 20px;
        border-radius: 8px;
        margin: 15px 0;
        overflow-x: auto;
        font-family: "Courier New", monospace;
        font-size: 14px;
        white-space: pre;
        line-height: 1.5;
        tab-size: 4;
      }

      .code-block .comment {
        color: #68d391;
      }
      .code-block .keyword {
        color: #f093fb;
      }
      .code-block .string {
        color: #fbb6ce;
      }

      .visual-example {
        background: #f7fafc;
        border: 2px solid #e2e8f0;
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
      }

      .bucket-visualization {
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 20px 0;
        flex-wrap: wrap;
        gap: 10px;
      }

      .bucket {
        border: 3px solid #667eea;
        border-radius: 10px;
        padding: 15px;
        background: #f0f4ff;
        text-align: center;
        min-width: 120px;
        transition: all 0.3s ease;
      }

      .bucket:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 12px rgba(102, 126, 234, 0.2);
      }

      .bucket-label {
        font-weight: bold;
        color: #667eea;
        margin-bottom: 10px;
        font-size: 0.9em;
      }

      .bucket-values {
        font-family: "Courier New", monospace;
        color: #2c3e50;
        font-size: 16px;
      }

      .highlight-box {
        background: linear-gradient(135deg, #667eea10, #764ba210);
        border: 1px solid #667eea;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .problem-statement {
        background: #e6fffa;
        border: 1px solid #38b2ac;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
      }

      .problem-statement h3 {
        color: #234e52;
        margin-bottom: 15px;
      }

      .step {
        display: flex;
        align-items: flex-start;
        margin: 20px 0;
        padding: 15px;
        background: white;
        border-radius: 8px;
        border: 1px solid #e2e8f0;
        transition: all 0.3s ease;
      }

      .step:hover {
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .step-counter {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        margin-right: 15px;
        flex-shrink: 0;
      }

      .step-content {
        flex-grow: 1;
      }

      .step-state {
        font-family: "Courier New", monospace;
        background: #f8f9fa;
        padding: 10px;
        border-radius: 5px;
        margin: 10px 0;
        font-size: 14px;
        border-left: 3px solid #667eea;
      }

      .complexity-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
      }

      .complexity-table th,
      .complexity-table td {
        border: 1px solid #e2e8f0;
        padding: 12px;
        text-align: left;
      }

      .complexity-table th {
        background: #f7fafc;
        font-weight: bold;
        color: #2d3748;
      }

      .complexity-table tr:nth-child(even) {
        background: #f9f9f9;
      }

      .tip-box {
        background: #fffbeb;
        border: 1px solid #f59e0b;
        border-radius: 8px;
        padding: 20px;
        margin: 20px 0;
        border-left: 4px solid #f59e0b;
      }

      .tip-box h4 {
        color: #92400e;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .tip-box h4::before {
        content: "üí°";
      }

      .match-found {
        background: #c6f6d5;
        border: 3px solid #38a169;
        color: #22543d;
        border-radius: 8px;
        padding: 15px;
        margin: 15px 0;
        font-weight: bold;
        text-align: center;
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      .algorithm-flow {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin: 20px 0;
      }

      .flow-step {
        flex: 1;
        min-width: 200px;
        padding: 15px;
        background: #f7fafc;
        border: 2px solid #e2e8f0;
        border-radius: 8px;
        text-align: center;
        position: relative;
      }

      .flow-step::after {
        content: "‚Üí";
        position: absolute;
        right: -25px;
        top: 50%;
        transform: translateY(-50%);
        font-size: 20px;
        color: #667eea;
        font-weight: bold;
      }

      .flow-step:last-child::after {
        display: none;
      }

      .interactive-demo {
        background: #f7fafc;
        border: 2px solid #667eea;
        border-radius: 10px;
        padding: 20px;
        margin: 20px 0;
      }

      .demo-controls {
        text-align: center;
        margin: 20px 0;
      }

      .demo-button {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        margin: 0 10px;
        transition: all 0.3s ease;
      }

      .demo-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
      }

      .array-display {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 20px 0;
        flex-wrap: wrap;
      }

      .array-element {
        padding: 10px 15px;
        border: 2px solid #cbd5e0;
        border-radius: 6px;
        background: #f7fafc;
        font-family: "Courier New", monospace;
        font-size: 16px;
        min-width: 50px;
        text-align: center;
        transition: all 0.3s ease;
      }

      .array-element.current {
        border-color: #f59e0b;
        background: #fffbeb;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(245, 158, 11, 0.2);
      }

      .array-element.checked {
        border-color: #38a169;
        background: #c6f6d5;
      }

      .array-element.match {
        border-color: #e53e3e;
        background: #fed7d7;
        animation: pulse 1s infinite;
      }

      @media (max-width: 768px) {
        .container {
          padding: 10px;
        }
        .header h1 {
          font-size: 2em;
        }
        .algorithm-flow {
          flex-direction: column;
        }
        .flow-step::after {
          display: none;
        }
        .bucket-visualization {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>ü™£ Bucket Pattern: Complete Guide</h1>
        <p>Master Proximity Problems with O(n) Time Complexity</p>
      </div>

      <div class="content-card">
        <div class="section">
          <h2 class="section-title">üéØ Problem Understanding</h2>

          <div class="problem-statement">
            <h3>LeetCode Problem: Contains Duplicate III</h3>
            <p>
              <strong>Given:</strong> Integer array <code>nums</code>, integers
              <code>indexDiff</code> and <code>valueDiff</code>
            </p>
            <p>
              <strong>Find:</strong> If there exists pair of indices
              <code>(i, j)</code> such that:
            </p>
            <ul>
              <li><code>i != j</code> (different indices)</li>
              <li><code>abs(i - j) <= indexDiff</code> (close indices)</li>
              <li>
                <code>abs(nums[i] - nums[j]) <= valueDiff</code> (close values)
              </li>
            </ul>

            <div class="visual-example">
              <strong>Example:</strong>
              <div class="code-block">
                Input: nums = [1,2,3,1], indexDiff = 3, valueDiff = 0 Output:
                true Explanation: Indices (0,3) satisfy all conditions
              </div>
            </div>
          </div>

          <div class="subsection">
            <h3>Why This Problem is Tricky</h3>
            <ul>
              <li>
                <strong>Dual Constraints:</strong> Both spatial (index) and
                value proximity required
              </li>
              <li>
                <strong>Efficiency Challenge:</strong> Naive O(n¬≤) approach too
                slow for large inputs
              </li>
              <li>
                <strong>Edge Cases:</strong> Negative numbers, zero boundaries,
                exact matches
              </li>
            </ul>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üîç Why Bucket Pattern?</h2>

          <div class="highlight-box">
            <h3>üéØ The Core Insight</h3>
            <p>
              <strong>Key Realization:</strong> If we group values into buckets
              of size <code>valueDiff + 1</code>, then any two values in the
              same bucket will differ by at most <code>valueDiff</code>. Values
              in adjacent buckets might also satisfy the constraint.
            </p>
          </div>

          <div class="subsection">
            <h3>Bucket Strategy Visualization</h3>
            <p><strong>For valueDiff = 2:</strong></p>
            <div class="bucket-visualization">
              <div class="bucket">
                <div class="bucket-label">Bucket -1</div>
                <div class="bucket-values">[-5,-4,-3]</div>
              </div>
              <div class="bucket">
                <div class="bucket-label">Bucket 0</div>
                <div class="bucket-values">[0,1,2]</div>
              </div>
              <div class="bucket">
                <div class="bucket-label">Bucket 1</div>
                <div class="bucket-values">[3,4,5]</div>
              </div>
              <div class="bucket">
                <div class="bucket-label">Bucket 2</div>
                <div class="bucket-values">[6,7,8]</div>
              </div>
            </div>

            <div class="algorithm-flow">
              <div class="flow-step">
                <strong>Same bucket</strong><br />
                Guaranteed match<br />
                (difference ‚â§ valueDiff)
              </div>
              <div class="flow-step">
                <strong>Adjacent buckets</strong><br />
                Need to verify<br />
                distance ‚â§ valueDiff
              </div>
              <div class="flow-step">
                <strong>Non-adjacent buckets</strong><br />
                Impossible to satisfy<br />
                constraint
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">‚öôÔ∏è Algorithm Deep Dive</h2>

          <div class="subsection">
            <h3>Core Implementation</h3>
            <div class="code-block">
              class Solution(object): def containsNearbyAlmostDuplicate(self,
              nums, indexDiff, valueDiff): if valueDiff < 0: return False bucket
              = {} w = valueDiff + 1 # Bucket size for i, num in
              enumerate(nums): m = num // w # Bucket ID # Check same bucket
              (guaranteed match) if m in bucket: return True # Check adjacent
              buckets if m - 1 in bucket and abs(num - bucket[m - 1]) < w:
              return True if m + 1 in bucket and abs(num - bucket[m + 1]) < w:
              return True # Add current number to its bucket bucket[m] = num #
              Maintain sliding window if i >= indexDiff: del bucket[nums[i -
              indexDiff] // w] return False
            </div>
          </div>

          <div class="algorithm-flow">
            <div class="flow-step">
              <strong>Initialize</strong><br />
              Create bucket map<br />
              Set bucket size = valueDiff + 1
            </div>
            <div class="flow-step">
              <strong>Calculate</strong><br />
              Bucket ID using<br />
              integer division
            </div>
            <div class="flow-step">
              <strong>Check</strong><br />
              Same & adjacent<br />
              buckets for matches
            </div>
            <div class="flow-step">
              <strong>Maintain</strong><br />
              Sliding window by<br />
              removing old elements
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üìä Complete Example Walkthrough</h2>

          <div class="interactive-demo">
            <h3>
              Interactive Demo: nums = [1,2,3,1], indexDiff = 3, valueDiff = 0
            </h3>

            <div class="visual-example">
              <strong>Setup:</strong> w = 0 + 1 = 1 (bucket size)

              <div class="array-display" id="array-demo">
                <div class="array-element">1</div>
                <div class="array-element">2</div>
                <div class="array-element">3</div>
                <div class="array-element">1</div>
              </div>

              <div class="demo-controls">
                <button class="demo-button" onclick="nextStep()">
                  Next Step
                </button>
                <button class="demo-button" onclick="resetDemo()">
                  Reset Demo
                </button>
              </div>

              <div id="demo-output">
                <div class="step-state">
                  Current State: Ready to start Buckets: {} Step: 0/4
                </div>
              </div>
            </div>
          </div>

          <div class="subsection">
            <h3>Step-by-Step Trace</h3>

            <div class="step">
              <div class="step-counter">1</div>
              <div class="step-content">
                <strong>Process index 0, num = 1</strong>
                <div class="step-state">
                  Bucket ID: 1 // 1 = 1 Buckets: {} (empty) Check: No buckets to
                  check Action: bucket[1] = 1 Result: bucket = {1: 1}
                </div>
              </div>
            </div>

            <div class="step">
              <div class="step-counter">2</div>
              <div class="step-content">
                <strong>Process index 1, num = 2</strong>
                <div class="step-state">
                  Bucket ID: 2 // 1 = 2 Buckets: {1: 1} Check same bucket (2):
                  Not found Check bucket 1: Found value 1, abs(2-1) = 1 < 1?
                  False Check bucket 3: Not found Action: bucket[2] = 2 Result:
                  bucket = {1: 1, 2: 2}
                </div>
              </div>
            </div>

            <div class="step">
              <div class="step-counter">3</div>
              <div class="step-content">
                <strong>Process index 2, num = 3</strong>
                <div class="step-state">
                  Bucket ID: 3 // 1 = 3 Buckets: {1: 1, 2: 2} Check same bucket
                  (3): Not found Check bucket 2: Found value 2, abs(3-2) = 1 <
                  1? False Check bucket 4: Not found Action: bucket[3] = 3
                  Result: bucket = {1: 1, 2: 2, 3: 3}
                </div>
              </div>
            </div>

            <div class="step">
              <div class="step-counter">4</div>
              <div class="step-content">
                <strong>Process index 3, num = 1 üéâ</strong>
                <div class="step-state">
                  Bucket ID: 1 // 1 = 1 Buckets: {1: 1, 2: 2, 3: 3} Check same
                  bucket (1): Found value 1! ‚úÖ
                </div>
                <div class="match-found">
                  üéâ FOUND MATCH at indices (0,3)!<br />
                  Return True
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üìà Complexity Analysis</h2>

          <table class="complexity-table">
            <thead>
              <tr>
                <th>Approach</th>
                <th>Time Complexity</th>
                <th>Space Complexity</th>
                <th>Explanation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Brute Force</td>
                <td>O(n √ó indexDiff)</td>
                <td>O(1)</td>
                <td>Check all pairs within range</td>
              </tr>
              <tr style="background: #c6f6d5">
                <td><strong>Bucket Pattern</strong></td>
                <td><strong>O(n)</strong></td>
                <td><strong>O(indexDiff)</strong></td>
                <td><strong>Each element processed once</strong></td>
              </tr>
              <tr>
                <td>SortedSet</td>
                <td>O(n log indexDiff)</td>
                <td>O(indexDiff)</td>
                <td>Binary search operations</td>
              </tr>
            </tbody>
          </table>

          <div class="highlight-box">
            <h3>Why O(n) Time?</h3>
            <ul>
              <li>
                <strong>Each element visited once:</strong> Single pass through
                array
              </li>
              <li>
                <strong>Constant bucket operations:</strong> Hash map
                insert/delete/lookup all O(1)
              </li>
              <li>
                <strong>Limited bucket checks:</strong> At most 3 buckets
                checked per element
              </li>
              <li>
                <strong>Bounded space:</strong> At most
                <code>indexDiff + 1</code> elements in buckets at any time
              </li>
            </ul>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üí° Pro Tips & Tricks</h2>

          <div class="tip-box">
            <h4>Pattern Recognition</h4>
            <ul>
              <li>
                <strong>"Close indices + close values"</strong> ‚Üí Consider
                bucket pattern
              </li>
              <li>
                <strong>Small value differences</strong> ‚Üí Bucket pattern is
                optimal
              </li>
              <li>
                <strong>Large arrays with proximity constraints</strong> ‚Üí O(n)
                matters over O(n log k)
              </li>
            </ul>
          </div>

          <div class="tip-box">
            <h4>Implementation Tips</h4>
            <ul>
              <li>
                <strong>Bucket size = valueDiff + 1:</strong> Ensures
                same-bucket elements satisfy constraint
              </li>
              <li>
                <strong>Check 3 buckets max:</strong> Current bucket + two
                adjacent buckets
              </li>
              <li>
                <strong>Sliding window maintenance:</strong> Remove element at
                <code>i - indexDiff</code> when <code>i >= indexDiff</code>
              </li>
              <li>
                <strong>Distance check:</strong> Use <code>< w</code> instead of
                <code>‚â§ valueDiff</code> for adjacent buckets
              </li>
            </ul>
          </div>

          <div class="tip-box">
            <h4>Why `< w` Works</h4>
            <div class="code-block">
              # For adjacent bucket elements: # Max difference = w - 1 =
              (valueDiff + 1) - 1 = valueDiff # So checking `< w` is equivalent
              to checking `‚â§ valueDiff` abs(num - bucket[adjacent]) < w #
              Correct!
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üß™ Edge Cases & Additional Examples</h2>

          <div class="subsection">
            <h3>Example 1: Negative Numbers</h3>
            <div class="visual-example">
              <div class="code-block">
                Input: nums = [-1, 0, 1], indexDiff = 1, valueDiff = 1
              </div>
              <div class="step-state">
                w = 2, indexDiff = 1 i=0, num=-1: bucket = -1//2 = -1, buckets =
                {-1: -1} i=1, num=0: bucket = 0//2 = 0 Check bucket 0: Not found
                Check bucket -1: Found -1, abs(0-(-1)) = 1 < 2 ‚úÖ MATCH found!
              </div>
            </div>
          </div>

          <div class="subsection">
            <h3>Example 2: Large Value Differences</h3>
            <div class="visual-example">
              <div class="code-block">
                Input: nums = [1, 10, 20], indexDiff = 2, valueDiff = 5
              </div>
              <p>
                <strong>Analysis:</strong> All elements in different buckets,
                differences > 5, returns False
              </p>
            </div>
          </div>

          <div class="subsection">
            <h3>Example 3: Exact Matches (valueDiff = 0)</h3>
            <div class="visual-example">
              <div class="code-block">
                Input: nums = [1, 2, 1], indexDiff = 2, valueDiff = 0
              </div>
              <p>
                <strong>Bucket size = 1:</strong> Each value gets its own
                bucket, only same bucket matches count
              </p>
            </div>
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üöÄ Final Code Implementation</h2>

          <div class="code-block">
            class Solution(object): def containsNearbyAlmostDuplicate(self,
            nums, indexDiff, valueDiff): """ Bucket pattern solution for
            Contains Duplicate III. Time: O(n), Space: O(min(n, indexDiff))
            Args: nums: List[int] - Array of integers indexDiff: int - Maximum
            index distance valueDiff: int - Maximum value distance Returns: bool
            - True if valid pair exists """ if valueDiff < 0: return False
            bucket = {} w = valueDiff + 1 # Bucket size for i, num in
            enumerate(nums): m = num // w # Bucket ID # Same bucket = guaranteed
            match if m in bucket: return True # Check adjacent buckets if m - 1
            in bucket and abs(num - bucket[m - 1]) < w: return True if m + 1 in
            bucket and abs(num - bucket[m + 1]) < w: return True # Add to bucket
            and maintain sliding window bucket[m] = num if i >= indexDiff: del
            bucket[nums[i - indexDiff] // w] return False
          </div>
        </div>

        <div class="section">
          <h2 class="section-title">üèÜ Mastery Summary</h2>

          <div class="highlight-box">
            <p
              style="
                text-align: center;
                font-style: italic;
                font-size: 1.1em;
                margin-bottom: 20px;
              "
            >
              "The bucket pattern transforms proximity problems from O(n¬≤) brute
              force to O(n) elegance by leveraging the mathematical property
              that nearby values cluster in predictable ranges."
            </p>

            <div class="algorithm-flow">
              <div class="flow-step">
                <strong>‚úÖ Core Concept</strong><br />
                Bucket size = constraint + 1<br />
                ensures same-bucket validity
              </div>
              <div class="flow-step">
                <strong>‚úÖ Efficiency</strong><br />
                O(n) time through<br />
                constant bucket operations
              </div>
              <div class="flow-step">
                <strong>‚úÖ Space Management</strong><br />
                Sliding window keeps<br />
                memory bounded
              </div>
              <div class="flow-step">
                <strong>‚úÖ Edge Handling</strong><br />
                Works with negatives, zeros,<br />
                and boundary cases
              </div>
              <div class="flow-step">
                <strong>‚úÖ Pattern Recognition</strong><br />
                Identify when bucketing<br />
                applies vs alternatives
              </div>
            </div>

            <div
              style="
                text-align: center;
                margin-top: 30px;
                font-size: 1.2em;
                font-weight: bold;
                color: #667eea;
              "
            >
              üéØ Master the pattern, ace the interview! üöÄ
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 0;
      const steps = [
        {
          step: 1,
          index: 0,
          num: 1,
          bucketId: 1,
          buckets: { 1: 1 },
          message:
            "Process index 0, num = 1\nBucket ID: 1 // 1 = 1\nBuckets: {} (empty)\nCheck: No buckets to check\nAction: bucket[1] = 1\nResult: bucket = {1: 1}",
        },
        {
          step: 2,
          index: 1,
          num: 2,
          bucketId: 2,
          buckets: { 1: 1, 2: 2 },
          message:
            "Process index 1, num = 2\nBucket ID: 2 // 1 = 2\nBuckets: {1: 1}\nCheck same bucket (2): Not found\nCheck bucket 1: Found value 1, abs(2-1) = 1 < 1? False\nCheck bucket 3: Not found\nAction: bucket[2] = 2\nResult: bucket = {1: 1, 2: 2}",
        },
        {
          step: 3,
          index: 2,
          num: 3,
          bucketId: 3,
          buckets: { 1: 1, 2: 2, 3: 3 },
          message:
            "Process index 2, num = 3\nBucket ID: 3 // 1 = 3\nBuckets: {1: 1, 2: 2}\nCheck same bucket (3): Not found\nCheck bucket 2: Found value 2, abs(3-2) = 1 < 1? False\nCheck bucket 4: Not found\nAction: bucket[3] = 3\nResult: bucket = {1: 1, 2: 2, 3: 3}",
        },
        {
          step: 4,
          index: 3,
          num: 1,
          bucketId: 1,
          buckets: { 1: 1, 2: 2, 3: 3 },
          message:
            "Process index 3, num = 1 üéâ\nBucket ID: 1 // 1 = 1\nBuckets: {1: 1, 2: 2, 3: 3}\nCheck same bucket (1): Found value 1! ‚úÖ\nüéâ FOUND MATCH at indices (0,3)!\nReturn True",
          isMatch: true,
        },
      ];

      function nextStep() {
        if (currentStep >= steps.length) {
          return;
        }

        const stepData = steps[currentStep];
        const arrayElements = document.querySelectorAll(
          "#array-demo .array-element"
        );
        const output = document.getElementById("demo-output");

        // Reset all elements
        arrayElements.forEach((el, idx) => {
          el.className = "array-element";
          if (idx < stepData.index) {
            el.classList.add("checked");
          }
          if (idx === stepData.index) {
            el.classList.add("current");
            if (stepData.isMatch) {
              el.classList.add("match");
              // Also highlight the matching element
              arrayElements[0].classList.add("match");
            }
          }
        });

        // Update output
        const bucketsDisplay = JSON.stringify(stepData.buckets).replace(
          /"/g,
          ""
        );
        output.innerHTML = `
                <div class="step-state">
                    Current State: Step ${stepData.step}/4
                    Buckets: ${bucketsDisplay}
                    Processing: Index ${stepData.index}, Value ${stepData.num}
                </div>
                <div class="step-state" style="white-space: pre-line; margin-top: 10px;">
                    ${stepData.message}
                </div>
            `;

        if (stepData.isMatch) {
          output.innerHTML += `
                    <div class="match-found" style="margin-top: 15px;">
                        üéâ ALGORITHM COMPLETE - MATCH FOUND! üéâ
                    </div>
                `;
        }

        currentStep++;
      }

      function resetDemo() {
        currentStep = 0;
        const arrayElements = document.querySelectorAll(
          "#array-demo .array-element"
        );
        const output = document.getElementById("demo-output");

        arrayElements.forEach((el) => {
          el.className = "array-element";
        });

        output.innerHTML = `
                <div class="step-state">
                    Current State: Ready to start
                    Buckets: {}
                    Step: 0/4
                </div>
            `;
      }

      // Add some interactive hover effects
      document.addEventListener("DOMContentLoaded", function () {
        // Add hover effects to buckets
        const buckets = document.querySelectorAll(".bucket");
        buckets.forEach((bucket) => {
          bucket.addEventListener("mouseenter", function () {
            this.style.transform = "translateY(-5px) scale(1.05)";
            this.style.boxShadow = "0 10px 20px rgba(102, 126, 234, 0.3)";
          });

          bucket.addEventListener("mouseleave", function () {
            this.style.transform = "translateY(0) scale(1)";
            this.style.boxShadow = "none";
          });
        });

        // Add click effect to demo buttons
        const buttons = document.querySelectorAll(".demo-button");
        buttons.forEach((button) => {
          button.addEventListener("click", function () {
            this.style.transform = "scale(0.95)";
            setTimeout(() => {
              this.style.transform = "translateY(-2px)";
            }, 150);
          });
        });

        // Add smooth scrolling for internal navigation
        const sections = document.querySelectorAll(".section");
        sections.forEach((section, index) => {
          section.addEventListener("click", function (e) {
            if (e.target === this) {
              this.scrollIntoView({ behavior: "smooth", block: "start" });
            }
          });
        });

        // Add code highlighting animation
        const codeBlocks = document.querySelectorAll(".code-block");
        codeBlocks.forEach((block) => {
          block.addEventListener("mouseenter", function () {
            this.style.boxShadow = "0 5px 15px rgba(0,0,0,0.2)";
            this.style.transform = "translateY(-2px)";
          });

          block.addEventListener("mouseleave", function () {
            this.style.boxShadow = "none";
            this.style.transform = "translateY(0)";
          });
        });
      });

      // Add keyboard navigation
      document.addEventListener("keydown", function (e) {
        if (e.key === "ArrowRight" || e.key === " ") {
          e.preventDefault();
          nextStep();
        } else if (e.key === "ArrowLeft" || e.key === "r") {
          e.preventDefault();
          resetDemo();
        }
      });

      // Add scroll-based animations
      const observerOptions = {
        threshold: 0.1,
        rootMargin: "0px 0px -50px 0px",
      };

      const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.style.opacity = "1";
            entry.target.style.transform = "translateY(0)";
          }
        });
      }, observerOptions);

      // Observe all sections for scroll animations
      document.addEventListener("DOMContentLoaded", function () {
        const animatedElements = document.querySelectorAll(
          ".section, .step, .tip-box, .highlight-box"
        );
        animatedElements.forEach((el) => {
          el.style.opacity = "0";
          el.style.transform = "translateY(20px)";
          el.style.transition = "opacity 0.6s ease, transform 0.6s ease";
          observer.observe(el);
        });
      });
    </script>
  </body>
</html>
